%include "io64.inc"

section .text
global main
main:
    ;write your code here
    GET_DEC 4, a
    mov ecx, [a]
    mov ebx, 2 
    mov r8d, 0
    
find_candidate:
    mov esi, 2
    
prime_find:    
    cmp esi, ebx
    jge prime_found
    mov eax, ebx
    xor edx, edx
    div esi
    cmp edx, 0
    je prime_not
    inc esi
    jmp prime_find

prime_found:
    mov [you+r8d*4], ebx
    inc r8d
    
prime_not:
    inc ebx
    cmp ebx, ecx
    jle find_candidate
    
    mov eax, 0
    mov ebx, 0
    
    PRINT_STRING msg1
    NEWLINE
    
print:
    PRINT_DEC 4, you+eax*4
    NEWLINE
    add ebx, [you+eax*4]
    inc eax
    cmp eax, r8d
    jl print
    
    PRINT_STRING msg2
    PRINT_DEC 4, ebx
            
    xor rax, rax
    ret
    
section .data
    msg1 db 'list of primes : ', 0x00
    msg2 db 'sum of primes : ', 0x00    
    
section .bss
    a resd 1
    you resd 32
